<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <title>chingaderas</title>
  
  <label for="presetSelect">Select an preset:</label>
<select style="background-color: #10ac858b; color: #ffb030;" id="presetSelect" onchange="cambiarPreset(this.value)">
</select>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px;
      background-color: #202021;
      color: #827154;
      transition: background-color 0.3s, color 0.3s;
    }
    textarea {
      width: 80%;
      height: 171px;
      font-size: 16px;
      background-color: #303030;
      color: #827154;
      border: 1px solid #444;
    }
    input[type="number"], select, input[type="range"] {
      font-size: 12px;
      max-width: 100px;
      margin: 5px;
    }
    button {
      margin-top: 20px;
      font-size: 18px;
      padding: 10px 20px;
      cursor: pointer;
    }
    #resultado {
      margin-top: 30px;
      font-size: 24px;
      font-weight: bold;
    }
    .top-right {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .controls {
      margin-top: 10px;
    }
    .light-mode {
      background-color: #f0f8ff;
      color: #000;
    }
    .light-mode textarea {
      background-color: #fff;
      color: #000;
      border: 1px solid #ccc;
    }
    #pawma-img {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 300px;
      transform: scale(calc(1 / var(--zoom-factor, 1)));
      transform-origin: bottom right;
      will-change: transform;
      z-index: 9999;
    }
     #pinche-pendejo {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 200px;
      transform: scale(calc(1 / var(--zoom-factor, 1)));
      transform-origin: bottom left;
      will-change: transform;
      z-index: 9999;
    }
     #flameadas {
      position: fixed;
      bottom: 0;
      left: 0;
      top: 240px;
      width: 150px;
      transform: scale(calc(1 / var(--zoom-factor, 1)));
      transform-origin: bottom left;
      will-change: transform;
      z-index: 9999;
    }

.solo-pc {
  display: block;
}

.solo-movil {
  display: none;
}

/* ===== MODO POR ESCALA ===== */

.modo-movil .solo-pc {
  display: none;
}

.modo-movil .solo-movil {
  display: block;
}

.modo-pc .solo-movil {
  display: none;
}

.modo-pc .solo-pc {
  display: block;
}

/* ajustes visuales en m√≥vil */
.modo-movil textarea {
  height: 111px;
}

.modo-movil #pawma-img {
  width: 150px;
}

.modo-movil #pinche-pendejo {
  width: 120px;
}

.modo-movil #flameadas {
  top: 400px;
  width: 120px;
}

  </style>
</head>
<body>

  <div class="top-right">
    <button style="background-color: #00000000; color: #876445; border-color: #00000000;" button onclick="toggleTheme()">üåô/‚òÄÔ∏è</button>
  </div>

  <h2><span id="gato">üêà‚Äç‚¨õ</span> chingadera para elegir chingaderas alazar</h2>
    <p>Opciones (separadas por comas):</p>
      <textarea id="opciones"></textarea>
         <br><br>
            <label for="cantidad">¬øCu√°ntas chingaderas elegir?</label>
              <input style="background-color: #10ac858b; color: #ffb030;" input type="number" id="cantidad" min="1" value="1">

  <div class="controls">
    <input type="range" id="volumen" min="0" max="1.5" step="0.01" value="1">
      <select style="background-color: #10ac858b; color: #ca8414;" select id="voiceSelect"></select>
        </div>

  <button style="background-color: #10ac858b; color: #ffb030;" button onclick="elegirOpciones()">Picamela</button>
    <div id="resultado"></div>

  <img src="multimedia/pawma_img.png" id="pawma-img" style="cursor: pointer;">
    <img src="multimedia/pinchependejo_avf.avif" id="pinche-pendejo" style="cursor: pointer;">
       <img src="multimedia/flamas777_webp.webp" id="flameadas" style="cursor: pointer;">

    <audio id="pawma">
      <source src="multimedia/pawma.mp3" type="audio/mpeg">
    
        <audio id="sonido-gato">
           <source src="multimedia/gatooo.ogg" type="audio/mpeg"> 

              <audio id="pendejo">
                <source src="multimedia/pinchependejo.mp3" type="audio/mpeg"> 

                  <audio id="bob">
                     <source src="multimedia/bob_poronga.ogg" type="audio/mpeg"> 

                        <audio id="flamas">   
                            <source src="multimedia/flamas777.ogg" type="audio/mpeg"> 

  <script>

    const audioGato = document.getElementById("sonido-gato");
    const pawmaImg = document.getElementById('pawma-img');
    const pawmaMp3 = document.getElementById('pawma');
    const flamaspuntocom = document.getElementById('flamas');
    const pinchePendejo = document.getElementById("pendejo"); 
    const voiceSelect = document.getElementById("voiceSelect");
    const volumenSlider = document.getElementById("volumen");
    
    const DEBUG_USAR_JSON_EMBEBIDO = false;

    let currentUtterance;
    let ttsTimeout = null;  
    let voices = [];
    let reproduciendo = false;
    let opcionesPredefinidas = {};

  const PRESETS_DEBUG = {

  };

  function cargarPresets() {
    if (DEBUG_USAR_JSON_EMBEBIDO) {
      console.warn("‚ö†Ô∏è MODO DEBUG: usando presets embebidos");
      inicializarPresets(PRESETS_DEBUG);
    } else {
      fetch("presets.json")
        .then(res => {
          if (!res.ok) throw new Error("No se pudo cargar presets.json");
          return res.json();
        })
        .then(data => inicializarPresets(data))
        .catch(err => {
          console.error(err);
          alert("‚ùå Error cargando presets.json");
        });
    }
  }

  function cambiarPreset(nombre) {
    const preset = opcionesPredefinidas[nombre];
    if (!preset) return;

    const textarea = document.getElementById("opciones");

    if (Array.isArray(preset)) {
      textarea.value = preset.join(", ");
    } else {
      textarea.value = preset; // data es string
    }
  }


  function inicializarPresets(data) {
    opcionesPredefinidas = data;
    const select = document.getElementById("presetSelect");
    select.innerHTML = "";

    let primerNombre = null;

    for (const nombre in opcionesPredefinidas) {
      if (!primerNombre) primerNombre = nombre;

      const option = document.createElement("option");
      option.value = nombre;
      option.textContent = nombre;
      select.appendChild(option);
    }

    if (primerNombre) {
      select.value = primerNombre;
      cambiarPreset(primerNombre);
    }
  }


      function actualizarZoomFactor() {
    const zoom = window.outerWidth / window.innerWidth;
    document.documentElement.style.setProperty('--zoom-factor', zoom);
  }


  function obtenerEscalaReal() {
    const viewportScale = window.visualViewport?.scale ?? 1;
    const windowScale = window.outerWidth / window.innerWidth;
    const dpr = window.devicePixelRatio || 1;

    return Math.max(viewportScale, windowScale, dpr);
  }

  function esModoMovil() {
    const escala = obtenerEscalaReal();
    const esTouch = navigator.maxTouchPoints > 0;
    const esUA_Movil = /Android|iPhone|iPad/i.test(navigator.userAgent);

    return (
      escala >= 1.45 ||   // ‚Üê antes 1.6
      esTouch ||          // pantallas t√°ctiles
      esUA_Movil          // emulaci√≥n / m√≥vil real
    );
  }

  function actualizarModoPorEscala() {
    const movil = esModoMovil();

    document.body.classList.toggle("modo-movil", movil);
    document.body.classList.toggle("modo-pc", !movil);

    console.log(
      "üì± modo:", movil ? "m√≥vil" : "PC",
      "| escala:", obtenerEscalaReal().toFixed(2)
    );
  }

  actualizarZoomFactor();
  window.addEventListener('resize', actualizarZoomFactor);

  actualizarModoPorEscala();

  window.addEventListener("resize", actualizarModoPorEscala);
  window.visualViewport?.addEventListener("resize", actualizarModoPorEscala);

  
          pawmaImg.addEventListener('click', () => {
          pawmaMp3.currentTime = 0;
          pawmaMp3.play();
        });
  
            document.getElementById("gato").addEventListener("click", () => {
          audioGato.volume = 0.2;
          audioGato.currentTime = 0;
          audioGato.play();
        });

        document.getElementById("pinche-pendejo").addEventListener("click", () => {
          if (!reproduciendo) {
            pinchePendejo.currentTime = 0;
            pinchePendejo.volume = 0.7;
            pinchePendejo.play();
            reproduciendo = true;
          } else {
            pinchePendejo.pause();
            pinchePendejo.currentTime = 0;
            reproduciendo = false;
          }
        });
    
        document.getElementById("flameadas").addEventListener("click", () => {
          if (!reproduciendo) {
            flamaspuntocom.currentTime = 0;
            flamaspuntocom.volume = 0.9;
            flamaspuntocom.play();
            reproduciendo = true;
          } else {
            flamaspuntocom.pause();
            flamaspuntocom.currentTime = 0;
            reproduciendo = false;
          }
        });


  function cargarVoces() {
    voices = speechSynthesis.getVoices().filter(v => v.lang.startsWith("es"));
    voiceSelect.innerHTML = "";
    voices.forEach((v, i) => {
      const option = document.createElement("option");
      option.value = i;
      option.textContent = `${v.name} (${v.lang})`;
      voiceSelect.appendChild(option);
    });
  }

  cargarVoces();
  speechSynthesis.onvoiceschanged = cargarVoces;

    function elegirOpciones() {
      const bobPoronga = document.getElementById("bob");
      const texto = document.getElementById('opciones').value.trim();
      const cantidad = parseInt(document.getElementById('cantidad').value);
            
      bobPoronga.currentTime = 0;
      bobPoronga.play();

      if (!texto) {
        alert("‚ùó Por favor, escribe al menos una opci√≥n.");
        return;
      }

      let opciones = texto.split(',').map(op => op.trim()).filter(op => op !== '');
      if (opciones.length === 0) {
        alert("‚ùó No hay opciones v√°lidas.");
        return;
      }

      if (cantidad > opciones.length) {
        alert(`‚ùó Solo hay ${opciones.length} opciones. No puedes elegir ${cantidad}.`);
        return;
      }
        
      if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
      }
      if (ttsTimeout) {
           clearTimeout(ttsTimeout);
            ttsTimeout = null;
        speechSynthesis.cancel();
      }
      
      opciones = opciones.sort(() => 0.5 - Math.random());
      const elegidas = opciones.slice(0, cantidad);

      const resultadoTexto = elegidas.map((op, i) => `${i + 1}. ${op}`).join('<br>');
      document.getElementById('resultado').innerHTML = `‚úÖ chingaderas elegidas:<br>${resultadoTexto}`;

      let mensajeTexto = "chingaderas para elegir, ";
      if (elegidas.length === 1) {
        mensajeTexto += elegidas[0];
      } else {
        const todasMenosUltima = elegidas.slice(0, -1).join(",, ");
        const ultima = elegidas[elegidas.length - 1];
        mensajeTexto += `${todasMenosUltima},, o, ${ultima}`;
      }

      currentUtterance = new SpeechSynthesisUtterance(mensajeTexto);
      currentUtterance.lang = voices.length > 0 ? voices[voiceSelect.value].lang : "es-ES";
      currentUtterance.voice = voices[voiceSelect.value];
      currentUtterance.volume = parseFloat(volumenSlider.value);
     ttsTimeout = setTimeout(() => {
    speechSynthesis.speak(currentUtterance);
    ttsTimeout = null;
  }, 555); // cooldown en ms
}  

    function toggleTheme() {
      document.body.classList.toggle("light-mode");
    }

  cargarPresets();

  </script>
</body>

</html>


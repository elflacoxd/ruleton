<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>chingaderas</title>
  
  <label for="presetSelect">Select an preset:</label>
<select style="background-color: #10ac858b; color: #ffb030;" id="presetSelect" onchange="cambiarPreset(this.value)">
  <option value=""> Presets </option>
</select>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px;
      background-color: #202021;
      color: #827154;
      transition: background-color 0.3s, color 0.3s;
    }
    textarea {
      width: 80%;
      height: 171px;
      font-size: 16px;
      background-color: #303030;
      color: #827154;
      border: 1px solid #444;
    }
    input[type="number"], select, input[type="range"] {
      font-size: 16px;
      margin: 5px;
    }
    button {
      margin-top: 20px;
      font-size: 18px;
      padding: 10px 20px;
      cursor: pointer;
    }
    #resultado {
      margin-top: 30px;
      font-size: 24px;
      font-weight: bold;
    }
    .top-right {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .controls {
      margin-top: 10px;
    }
    .light-mode {
      background-color: #f0f8ff;
      color: #000;
    }
    .light-mode textarea {
      background-color: #fff;
      color: #000;
      border: 1px solid #ccc;
    }
    #pawma-img {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 300px;
      transform: scale(calc(1 / var(--zoom-factor, 1)));
      transform-origin: bottom right;
      will-change: transform;
      z-index: 9999;
      animation: haciaCentro 2s ease-out forwards;
    }
     #pinche-pendejo {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 200px;
      transform: scale(calc(1 / var(--zoom-factor, 1)));
      transform-origin: bottom left;
      will-change: transform;
      z-index: 9999;
      animation: haciaCentro 2s ease-out forwards;
    }

  </style>
</head>
<body>
  <div class="top-right">
    <button style="background-color: #00000000; color: #876445; border-color: #00000000;" button onclick="toggleTheme()">üåô/‚òÄÔ∏è</button>
  </div>

  <h1><span id="gato">üêà‚Äç‚¨õ</span> chingadera para elegir chingaderas alazar</h1>
  <p>Opciones (separadas por comas):</p>
  <textarea id="opciones"></textarea>
  <br><br>
  <label for="cantidad">¬øCu√°ntas chingaderas elegir?</label>
  <input style="background-color: #10ac858b; color: #ffb030;" input type="number" id="cantidad" min="1" value="1">

  <div class="controls">
    <input type="range" id="volumen" min="0" max="1.5" step="0.01" value="1">
    <select style="background-color: #10ac858b; color: #ffb030;" select id="voiceSelect"></select>
  </div>

  <button style="background-color: #10ac858b; color: #ffb030;" button onclick="elegirOpciones()">Picamela</button>

  <div id="resultado"></div>

  <img src="multimedia/pawma_img.png" id="pawma-img" style="cursor: pointer;">
    <img src="https://cdn.7tv.app/emote/01JB0G5R1FY3NTAVG8CK3YCVCB/4x.avif" id="pinche-pendejo" style="cursor: pointer;">

    <audio id="pawma">
      <source src="multimedia/pawma.mp3" type="audio/mpeg">
    
        <audio id="sonido-gato">
           <source src="multimedia/gatooo.ogg" type="audio/mpeg"> 

              <audio id="pendejo">
                <source src="multimedia/pinchependejo.mp3" type="audio/mpeg"> 
                  <audio id="bob">
                     <source src="multimedia/bob_poronga.ogg" type="audio/mpeg"> 

  <script>

    


let opcionesPredefinidas = {};

fetch("presets.json")
  .then(res => res.json())
  .then(data => {
    opcionesPredefinidas = data;
    const select = document.getElementById("presetSelect");
    
    for (const nombre in opcionesPredefinidas) {
      const option = document.createElement("option");
      option.value = nombre;
      option.textContent = nombre;
      select.appendChild(option);
    }
    

    function cambiarPreset(nombre) {
  if (opcionesPredefinidas[nombre]) {
    const textarea = document.getElementById("opciones");
    textarea.value = opcionesPredefinidas[nombre].join(", ");
  }
}

    const voiceSelect = document.getElementById("voiceSelect");
    const volumenSlider = document.getElementById("volumen");
    let voices = [];
    let currentUtterance;
    let ttsTimeout = null;


      function actualizarZoomFactor() {
    const zoom = window.outerWidth / window.innerWidth;
    document.documentElement.style.setProperty('--zoom-factor', zoom);
  }

  actualizarZoomFactor();
  window.addEventListener('resize', actualizarZoomFactor);


  const img = document.getElementById('pawma-img');
  const audio = document.getElementById('pawma');

  img.addEventListener('click', () => {
    audio.currentTime = 0;
    audio.play();
  });

        document.getElementById("gato").addEventListener("click", () => {
      const audioGato = document.getElementById("sonido-gato");
      audioGato.volume = 0.2;
      audioGato.currentTime = 0;
      audioGato.play();
    });

          const pinchePendejo = document.getElementById("pendejo"); 
          let reproduciendo = false;

        document.getElementById("pinche-pendejo").addEventListener("click", () => {
          if (!reproduciendo) {
            pinchePendejo.currentTime = 0;
            pinchePendejo.volume = 0.5;
            pinchePendejo.play();
            reproduciendo = true;
          } else {
            pinchePendejo.pause();
            pinchePendejo.currentTime = 0;
            reproduciendo = false;
          }
        });

const voiceSelect = document.getElementById("voiceSelect");
function cargarVoces() {
  voices = speechSynthesis.getVoices().filter(v => v.lang.startsWith("es"));
  voiceSelect.innerHTML = "";
  voices.forEach((v, i) => {
    const option = document.createElement("option");
    option.value = i;
    option.textContent = `${v.name} (${v.lang})`;
    voiceSelect.appendChild(option);
  });
}

cargarVoces();
speechSynthesis.onvoiceschanged = cargarVoces;

    function elegirOpciones() {
      const bobPoronga = document.getElementById("bob");
      const texto = document.getElementById('opciones').value.trim();
      const cantidad = parseInt(document.getElementById('cantidad').value);
    
            
      bobPoronga.currentTime = 0;
      bobPoronga.play();

      if (!texto) {
        alert("‚ùó Por favor, escribe al menos una opci√≥n.");
        return;
      }

      let opciones = texto.split(',').map(op => op.trim()).filter(op => op !== '');
      if (opciones.length === 0) {
        alert("‚ùó No hay opciones v√°lidas.");
        return;
      }

      if (cantidad > opciones.length) {
        alert(`‚ùó Solo hay ${opciones.length} opciones. No puedes elegir ${cantidad}.`);
        return;
      }
        
      if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
      }
      if (ttsTimeout) {
           clearTimeout(ttsTimeout);
            ttsTimeout = null;
        speechSynthesis.cancel();
      }
      
      opciones = opciones.sort(() => 0.5 - Math.random());
      const elegidas = opciones.slice(0, cantidad);

      const resultadoTexto = elegidas.map((op, i) => `${i + 1}. ${op}`).join('<br>');
      document.getElementById('resultado').innerHTML = `‚úÖ chingaderas elegidas:<br>${resultadoTexto}`;

      let mensajeTexto = "  chingaderas para elegir, ";
      if (elegidas.length === 1) {
        mensajeTexto += elegidas[0];
      } else {
        const todasMenosUltima = elegidas.slice(0, -1).join(",, ");
        const ultima = elegidas[elegidas.length - 1];
        mensajeTexto += `${todasMenosUltima},, o, ${ultima}`;
      }

      currentUtterance = new SpeechSynthesisUtterance(mensajeTexto);
      currentUtterance.lang = voices.length > 0 ? voices[voiceSelect.value].lang : "es-ES";
      currentUtterance.voice = voices[voiceSelect.value];
      currentUtterance.volume = parseFloat(volumenSlider.value);
     ttsTimeout = setTimeout(() => {
    speechSynthesis.speak(currentUtterance);
    ttsTimeout = null;
  }, 555); // cooldown en ms
}  

    function toggleTheme() {
      document.body.classList.toggle("light-mode");
    }
  </script>
</body>
</html>
